
<!DOCTYPE html>
<html lang="en">
<!-- default layout-->
<!--map layout see _layouts/map.html-->
<head>
  <!--meta content and open graph tags for social sharing see _includes/metal.html-->
  <title>Leaflet & Vector Tiles | OVRDC</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@ovrdc">
  <meta name="twitter:creator" content="@ovrdc">
  <meta name="twitter:title" content="Leaflet & Vector Tiles">
  <meta name="twitter:description" content="A County Parcel Map built with Leaflet">
  <meta name="twitter:domain" content="www.ovrdc.org" />
  <meta name="twitter:image" content="https://www.ovrdc.org/apps/assets/post-images/large/parcels.png" />
  <!--Open Graph meta data-->
  <meta property="og:title" content="Leaflet & Vector Tiles" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="" />
  <meta property="og:image" content="https://www.ovrdc.org/apps/assets/post-images/landscape/parcels.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="627" />
  <meta property="og:image" content="https://www.ovrdc.org/apps/assets/post-images/large/parcels.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="1200" />
  <meta property="og:description" content="A County Parcel Map built with Leaflet" />
  <meta property="og:url" content="https://www.ovrdc.org/apps/geojson-tiles.html" />
  <!--end meta and open graph-->

  <!--global fonts and jquery-->
  <link href='//fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400italic,400,800,700|Archivo+Narrow:400,700|Archivo+Black' rel='stylesheet' type='text/css'>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js" integrity="sha256-wS9gmOZBqsqWxgIVgA8Y9WcQOa7PgSIX+rPA0VL2rbQ=" crossorigin="anonymous"></script>
  <!--Font Awesome CDN and Bootstrap CSS -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css" integrity="sha256-ymZGho+WjeQQ2jvjHInYJd0h20DI6/AE0fYq+BGYXqY=" crossorigin="anonymous" />
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <!--script type="text/javascript">$(document).ready(function () { $('.dropdown-toggle').dropdown(); }); </script-->

  <!--Begin Map CSS and JS see _includes/map-header.html-->
  <script src="https://maps.google.com/maps/api/js?v=3"></script>
  
  <!--Mapping via LeafletJS updated 07-15-2016 -->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js" integrity="sha256-aReBHzIjoMzKrp0H4XnxXIm0mwuNG/F+00pKDiFuLxI=" crossorigin="anonymous"></script> 
    
    
<link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.2/dist/leaflet.draw.css" />
    
   
    
  <link rel="stylesheet" href="https://www.ovrdc.org/apps/assets/ovrdc-map-plugins-leaflet-0.7.css" />
  <script src="https://www.ovrdc.org/apps/assets/ovrdc-map-plugins-leaflet-0.7.js"></script>
  
  <link rel="stylesheet" href="https://www.ovrdc.org/apps/assets/ovrdc-css/modern-ui.css" />
  <!--End Leaflet Plugins-->
  
  
  <script src="https://cdn.rawgit.com/mejackreed/Leaflet-IIIF/v2.0.1/leaflet-iiif.js"></script>
    <script src="https://unpkg.com/leaflet-draw@1.0.2/dist/leaflet.draw.js"></script>

  
  
  
  <!--additional page plugins see map-plugins.html and _data/plugins.yml -->
  <!-- end additional plugins-->
  <!--End Map CSS and JS-->
  <!--end plugins-->
  <style>*{font-family: "Open Sans", sans-serif;}
    
    
    ul.leaflet-draw-actions.leaflet-draw-actions-bottom li a[title="Save changes"],
ul.leaflet-draw-actions.leaflet-draw-actions-bottom li a[title="Cancel editing, discards all changes"] {
    display: none;
}
    
    
    </style>

</head>
<body>

<!--Start Map Post Content-->
<script src="http://www.sumbera.com/gist/js/vt/geojson-vt-dev.js"></script>
    <script src="http://www.sumbera.com/gist/js/leaflet/canvas/L.CanvasTiles.js"></script>
<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-pip/v0.1.0/leaflet-pip.min.js'></script>
    <script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script>
   
   
    
    
<div class="blank"><h2 class="animate-flicker" style="text-align:center;margin-top:50px;">Loading...</h2></div>
    <div>
        <select id='ul' style="position: absolute;z-index: 4 ; top: 70px;left: 10px;font-size: 22 ;">
    <option>Zoom to State</option>
            <option>Punjab</option>
            <option>Sindh</option>
            <option>KPK</option>
            <option>Baluchistan</option>
    </select>
        <input type="button" value="Clear Selected Zip Codes" id="clearselectedZips" style="position: absolute;z-index: 4 ; bottom: 275px;left: 25px;;">
        <input type="button" value="Select by Shape" id="selectbyShape" style="position: absolute;z-index: 4 ; bottom: 255px;left: 25px;">
<div id='map'>
    
          
<div id="sidebar" style="height: 300px;width: 150px">
    
      

    
  
    
	<b style="position: absolute;z-index: 4 ; top: 40px;right: 12px;;">Zip Codes</b>
                <input type="button" value="Get Zip Codes" id="getzip" style="position: absolute;z-index: 4 ; top: 10px;right: 13px;;">
                <div style="position: absolute;z-index: 3 ; top: 60px;right: 10px;;">
        <textarea id="ziplist" rows="10" cols="10"></textarea>
    </div>
    
    </div>
<div>
  <hr />
  <button id="showTools" type="button" class="btn btn-default btn-xs btn-block">Show Map Tools Legend</button>
  <button id="hideTools" type="button" class="btn btn-default btn-xs btn-block" style="display:none;">Hide Map Tools Legend</button>
  <div class="toolLegend" style="display:none;">
    <hr />
    <div class="list-group" style="text-align:left;">
      <li class="list-group-item" style="color: aqua"><i>Fetch ZipCodes</i> Open Sidebar</li>
      <li class="list-group-item" style="color: aqua"><i>Fetch ZipCodes</i> Open Sidebar</li>
      
      <li class="list-group-item"><i class='fa fa-exchange fa-fw fa-lg'></i> Toggle Address Search</li>
      
      <li class="list-group-item"><img src="https://www.ovrdc.org/apps/assets/images/fullscreen-img.png" style="padding:0 1px;width:22px;"></img> Fullscreen</li>
      <li class="list-group-item"><i class='fa fa-globe fa-fw fa-lg'></i> Default Map Extent</li>
      <li class="list-group-item"><i class='fa fa-map-marker fa-fw fa-lg'></i> Show/Follow Your Location</li>
      
      <li class="list-group-item"><i class='fa fa-cogs fa-fw fa-lg'></i> Toggle Map Tools (Mobile Only)</li>
      <li class="list-group-item"><img src="https://www.ovrdc.org/apps/assets/cssjs/images/layers-bl.png" style="padding:0 1px;width:22px;"></img> Toggle Map Layers</li>
      
    </div>
  </div>
  <hr />
</div>
<script>
$("#showTools").click(function() {
  $(".toolLegend").toggle();
  $("#showTools").toggle();
  $("#hideTools").toggle();
});
$("#hideTools").click(function() {
  $(".toolLegend").toggle();
  $("#showTools").toggle();
  $("#hideTools").toggle();
});
</script>

 
</div>

</div>
<script>
 
var map = L.map('map',{attributionControl: false,zoomControl:false,center: [30.321808, 70.288185],
    zoom: 6,
                       minZoom: 4,
                        zoomAnimationThreshold: 2,
	attribution : false,
		zoomSnap: 0
});

    

map.panBy([1,1]);
var gray = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}@2x.png').addTo(map);
    var dark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}@2x.png');
    var satellite =
      L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');

    var basemaps = {
      'Light': gray,
        'Dark': dark,
      'Satellite': satellite
    }
var ovrdcScale = L.control.scale({metric: false, imperial: true}).addTo(map);

    






var customZoom = L.control.zoom({position:'bottomright'}).addTo(map);



var overlays;
    
var sidebar = L.control.sidebar('sidebar', { autoPan: false, closeButton: false });
sidebar.addTo(map);
    
var hash = L.hash(map);
var gpsLocate = L.control.locate({follow: true, locateOptions: {enableHighAccuracy: true}});

var homeExtent = L.control.defaultExtent({});

var fullscreen = L.control.fullscreen();

var globalsearchToggle = new L.easyButton({
    states: [{
      stateName: 'show',
      icon: 'fa-exchange fa-lg',
      title: 'Search Addresses',
      onClick: function(btn, map) {
        osmsearch.addTo(map);
      btn.state('hide');
        }
      },{
      stateName: 'hide',
    icon: 'fa-exchange fa-border fa-lg',
      title: 'Search Features',
      onClick: function(btn, map) {
        map.removeControl(osmsearch);
        btn.state('show');
      }
    }]
  });
//globalsearchToggle.addTo(map);

var sidebarToggle = L.easyButton({
      states: [{
              stateName: 'open-sidebar',   // name the state
              icon:      'fa-bars fa-lg',          // and define it's properties
              title:     'Show Sidebar', // like it's title
              onClick: function(btn, map) {  // and it's callback
                  sidebar.show();
                  btn.state('close-sidebar'); // change state on click!
              }
          }, {
              stateName: 'close-sidebar',
              icon:      'fa-times fa-2x',
              title:     'Hide Sidebar',
              onClick: function(btn, map) {
                  sidebar.hide();
                  btn.state('open-sidebar');
              }
      }],
    id: 'menu',
 });
var stogglebar = L.easyBar([sidebarToggle], {id: 'toggle'}).addTo(map);
var leafletprint = L.easyPrint();
//end toolbar
sidebar.on('hide', function () {
    sidebarToggle.state('open-sidebar');
});
sidebar.on('show', function () {
    sidebarToggle.state('close-sidebar');
});
//mobile toolbar menu
//--tools toggle on small screens
var toolshidden = false;
var mobilescreen = false;
var tools = L.easyButton({
      states: [{
              stateName: 'show-tools',   // name the state
              icon:      'fa-cogs fa-lg',          // and define it's properties
              title:     'Show Map Tools', // like it's title
              onClick: function(btn, map) {  // and it's callback
                  leafletprint.addTo(map);
                  gpsLocate.addTo(map);
                  homeExtent.addTo(map);
                  fullscreen.addTo(map);
                  
                  globalsearchToggle.addTo(map);
                  
                  btn.state('hide-tools'); // change state on click!
                  toolshidden = false;
                  //console.log(toolshidden + ' state changed to hideTools');
              }
          }, {
              stateName: 'hide-tools',
              icon:      'fa-cogs fa-border fa-lg',
              title:     'Hide Map Tools',
              onClick: function(btn, map) {
                  map.removeControl(leafletprint);
                  map.removeControl(gpsLocate);
                  map.removeControl(homeExtent);
                  map.removeControl(fullscreen);
                  
                  map.removeControl(globalsearchToggle);
                  
                  btn.state('show-tools');
                  toolshidden = true;
                  //console.log(toolshidden+ ' state changed to showTools');
              }
      }],
    id: 'tools',
 });
console.log('tools loaded');
var w = window.innerWidth;
console.log('screen width: ' + w);
if (w < 481) {
  tools.addTo(map);
  toolshidden = true;
  mobilescreen = true;
  //console.log('mobile tool toggle');
  //console.log(toolshidden + "mobilescreen: " + mobilescreen);
}else{
  leafletprint.addTo(map);
  gpsLocate.addTo(map);
  homeExtent.addTo(map);
  fullscreen.addTo(map);
  
  globalsearchToggle.addTo(map);
  
  toolshidden = false;
  //console.log(toolshidden + " " + mobilescreen);
}
window.onresize = function() {
  if ( toolshidden === true && window.innerWidth > 480 && mobilescreen === true) {
    leafletprint.addTo(map);
    gpsLocate.addTo(map);
    homeExtent.addTo(map);
    fullscreen.addTo(map);
    
    globalsearchToggle.addTo(map);
    
    map.removeControl(tools);
    toolshidden = false;
    mobilescreen = false;
    //console.log(toolshidden + " " + mobilescreen);
  }
  else if ( toolshidden === false && mobilescreen === true && window.innerWidth > 481) {
    tools.state('show-tools');
    mobilescreen = false;
    map.removeControl(tools);
    //console.log(toolshidden + "" + mobilescreen);
  }
  else if ( toolshidden === false && window.innerWidth < 481 && mobilescreen === false) {
    map.removeControl(leafletprint);
    map.removeControl(gpsLocate);
    map.removeControl(homeExtent);
    map.removeControl(fullscreen);
    
    map.removeControl(globalsearchToggle);
    
    tools.addTo(map);
    toolshidden = true;
    mobilescreen = true;
    //console.log(toolshidden + " " + mobilescreen);
  }
  else {}
};
//--end tools toggle

//Close Layer Control on Layer Change
//Close Layer Control on Layer Change on mobile

//end mobile tools menu
var loading = L.Control.loading({position:'topright'}).addTo(map);
//end OVRDC Modern UI Toolbar

map.spin(true);

    
    
 let queue = L.layerGroup();      
    
var pikeParcels = L.geoJson(null, {
  onEachFeature: function(feature, layer) {
      
      
      
 
    
    
           (function(layer, properties) {
     
      layer.on("mouseover", function (e) {
       
        
     
        var popup = $("<div></div>", {
            id: "Zipcode" + properties.ADM3_PCODE,
            css: {
                position : "absolute",
                bottom: "85px",
                left: "50px",
                zIndex: 1002,
               padding: "6px 8px",
                font: "14px/16px Arial, Helvetica, sans-serif", 
                
                background: "orange",
                
                boxshadow: "0 0 15px rgba(0,0,0,0.2)",
                borderradius: "5px"
            }
        });
       
        var hed = $("<div></div>", {
            text: "ZipCode " + properties.ADM3_PCODE ,
            css: {fontSize: "16px", marginBottom: "3px"}
        }).appendTo(popup);
       
        popup.appendTo("#map");
      });
    
      layer.on("mouseout", function (e) {
     
        
      
        $("#popup-" + properties.ADM3_PCODE).remove();
      });
      
    })(layer, feature.properties);
    
    
    
    
    
    
    
            layer.on("click", function (e) { 
                
                //stateLayer.setStyle(style); 
               
                if(queue.hasLayer(layer)){
                    
                queue.removeLayer(layer);
                queue.eachLayer(function(layerq) {
                    
	               layerq.setStyle({
                        'color': 'red',
			fillOpacity: 0.2,
			fillColor: 'red'
                    });
                });
            } else {
                queue.addLayer(layer)
                
                //stateLayer.setStyle(style);
                      queue.eachLayer(function(layerq) {
	
                      layerq.setStyle({
                        'color': 'red',
			fillOpacity: 0.2,
			fillColor: 'red'
                      });
                    });
                
                
            }
                
            
            });

  },
	style: {color:'red'}
});

var tileData = omnivore.topojson("data/zipcodestopo.json", null, pikeParcels);
var search;
tileData.on('ready', function() {
  console.log('parcel data ready');
	
  $(".blank").fadeOut();
  map.spin(false);
	setTimeout(function() {
			sidebar.show()
	}, 500);
//initiate search after parcel data has loaded
  search = new L.Control.Search({
    layer: pikeParcels,
    propertyName: 'ADM3_PCODE',
    zoom: 11,
    collapsed: false,
    textPlaceholder: 'Search Zipcode',
    minLength: 4
  }).addTo(map);
  search.on('search_locationfound', function(e) {
    search.collapse();
    setTimeout(function() {
      map.fire('click', {latlng:e.latlng});
    }, 200);
  });
//end search
//----------
//start geojson-vt map tiles
//interaction on the underlying polygon not drawn but represented by the tiles - they draw better
    
    
    
  
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  
    
    

///// Draw controls
	


    
var drawnItems = new L.FeatureGroup();
map.addLayer(drawnItems);

var drawControlFull = new L.Control.Draw({
    position: 'bottomleft',
    edit: {
        featureGroup: drawnItems
    },
    draw: {
        polyline: false,
        polygon: false,
        marker: false,
       circleMarker: false
    }
});


var drawControlEditOnly = new L.Control.Draw({
    position: 'bottomleft',
    edit: {
        featureGroup: drawnItems
    },
    draw: false
});

map.addControl(drawControlFull);

map.on("draw:created", function (e) {
    var layer = e.layer;
    var type = e.layerType;
    layer.addTo(drawnItems);
    
});


    
    
    
  
    

    
  
    
  drawnItems.on('click', function(e) {});  
    
    
    
    
    
   
    
    
var highlight;
   
    
   
map.on('click', function(e) {
 
   var x = e.latlng.lng;
   var y = e.latlng.lat;
    
   
    
    
    
    
       
    
    
    
    
   var layerData = leafletPip.pointInLayer([x,y], pikeParcels, true);
   if (!layerData[0]) {
     console.log('nothing to see here')
   }else{
     
     var highlightIndex = layerData[0].feature.properties.ADM3_PCODE;
     highlight = new L.geoJson(data, {
         onEachFeature: function (feature, layer) {
             
             
             
             
             (function(layer, properties) {
     
      layer.on("mouseover", function (e) {
       
        
     
        var popup = $("<div></div>", {
            id: "Zipcode" + properties.ADM3_PCODE,
            css: {
                position : "absolute",
                bottom: "85px",
                left: "50px",
                zIndex: 1002,
               padding: "6px 8px",
                font: "14px/16px Arial, Helvetica, sans-serif", 
                
                background: "orange",
                
                boxshadow: "0 0 15px rgba(0,0,0,0.2)",
                borderradius: "5px"
            }
        });
       
        var hed = $("<div></div>", {
            text: "ZipCode " + properties.ADM3_PCODE ,
            css: {fontSize: "16px", marginBottom: "3px"}
        }).appendTo(popup);
       
        popup.appendTo("#map");
      });
    
      layer.on("mouseout", function (e) {
     
        
      
        $("#popup-" + properties.ADM3_PCODE).remove();
      });
      
    })(layer, feature.properties);
             
             
             
             
             queue.addLayer(layer)
                
                //stateLayer.setStyle(style);
                      queue.eachLayer(function(layerq) {
	
                      layerq.setStyle({
                        'color': 'red',
			fillOpacity: 0.2,
			fillColor: 'red'
                      });
                    });
             
             layer.on("click", function (e) {
             
                     if(queue.hasLayer(layer)){
                    
                queue.removeLayer(layer);
                queue.eachLayer(function(layerq) {
                    
	               layerq.setStyle({
                        'color': 'red',
			fillOpacity: 0.2,
			fillColor: 'red'
                    });
                });
            } else {
			
                 queue.addLayer(layer)
                
                //stateLayer.setStyle(style);
                      queue.eachLayer(function(layerq) {
	
                      layerq.setStyle({
                        'color': 'red',
			fillOpacity: 0.2,
			fillColor: 'red'
                      });
                    });
                
                
            }
             });
         },
       filter: function(feature, layer) {
           
         return feature.properties.ADM3_PCODE == highlightIndex
       },
      style: {color:'deepskyblue', fillColor:'deepskyblue'}});
    
           
       
     var attributes = highlightIndex.split('-', 2);
     var name = attributes[0];
     
    
     
   }
 });
    
    
    

    
    
    

    queue.addTo(map);
 

    
$("#ul").change(function(){
         var selValue = $(this).val();
         if(selValue=='Punjab'){
          map.panTo([ 31.739772, 73.320548] );
          map.setZoom(9);
         }
         if(selValue=='KPK'){
          var as= map.panTo([ 34.266292, 71.635130] )
          map.setZoom(9);
         }
         if(selValue=='Sindh'){
          var as= map.panTo([  26.121365, 68.773098] )
          map.setZoom(9);
         } if(selValue=='Baluchistan'){
          var as= map.panTo([  27.476690, 63.899695])
          map.setZoom(9);
         }    
    
    });

    
  
  
    
    
    
    
    
    

    
    
    
    
    
    
    
    
    $('#selectbyShape').click(function(){
               
        
        
        drawnItems.eachLayer(function(layerd) {
        
            if(layerd instanceof L.Circle){
                
                
                           var theCenterPt = layerd.getLatLng();
                var theRadius = layerd.getRadius();
                
                
                    
    pikeParcels.eachLayer(function (layer) {

       
        layer_lat_long = layer.getBounds().getCenter();
        
        distance_from_centerPoint = layer_lat_long.distanceTo(theCenterPt);
       
          if (distance_from_centerPoint <= theRadius) {
              //if(layerd.getBounds().intersects(layer.getBounds()) == true){
               
 
             queue.addLayer(layer)
   
//}

           
        }

    });
  
  
       
                
            }else{
                

                
                
                    
    pikeParcels.eachLayer(function (layer) {

       
       
        
        
       
        
              if(layerd.getBounds().intersects(layer.getBounds()) == true){
                 
 
             queue.addLayer(layer)
   
 
        }

    });
        
        
            }
     });
        
        
    });
    
    
    
    
    
    
   
    
    
    
    
    
    
    
    
    
 $('#getzip').click(function(){
        
        
       

     
        
            
         let  ziplist = document.getElementById('ziplist');
   
    var selectedgeo = queue.toGeoJSON();
    var featuresLayer = new L.GeoJSON(selectedgeo,{
			onEachFeature: function(feature, qlayer) {
               
				
                
                
                
                
                
                    let zipitem = document.createElement('li');
  
                zipitem.innerHTML = feature.properties.ADM3_PCODE;
                ziplist.appendChild(zipitem);
                
					
				
			}
		});
   
  });    
    
     $('#clearselectedZips').click(function(){ 
        queue.clearLayers();
    });
    
//end point in polygon
//geojson-vt
var tileOptions = {
    maxZoom: 22,  // max zoom to preserve detail on
    tolerance: 7, // 5 simplification tolerance (higher means simpler)
    extent: 4096, //4096, // 4096 tile extent (both width and height)
    buffer: 64,   // 64 default 64tile buffer on each side
    debug: 0,      // logging level (0 to disable, 1 or 2)
    indexMaxZoom: 0,        // 0 max zoom in the initial tile index
    indexMaxPoints: 100000, // 100000 max number of points per tile in the index
};
var data = pikeParcels.toGeoJSON();
var tileIndex = geojsonvt(data, tileOptions);
//take json output from geojson-vt and draw it with the now depricated (in leaflet-beta) L.canvasTiles and code from here - http://blog.sumbera.com/2015/05/31/geojson-vt-on-leaflet/
var tileLayer = L.canvasTiles().params({ debug: false, padding: 50 }).drawing(drawingOnCanvas);
var pad = 0;
    
    
tileLayer.addTo(map);
    
tileLayer.setZIndex(10);
function drawingOnCanvas(canvasOverlay, params) {

            var bounds = params.bounds;
            params.tilePoint.z = params.zoom;

            var ctx = params.canvas.getContext('2d');
            ctx.globalCompositeOperation = 'source-over';


            //console.log('getting tile z' + params.tilePoint.z + '-' + params.tilePoint.x + '-' + params.tilePoint.y);

            var tile = tileIndex.getTile(params.tilePoint.z, params.tilePoint.x, params.tilePoint.y);
            if (!tile) {
                //console.log('tile empty');
                return;
            }

            ctx.clearRect(0, 0, params.canvas.width, params.canvas.height);

            var features = tile.features;

            ctx.strokeStyle = 'orange';


            for (var i = 0; i < features.length; i++) {
                var feature = features[i],
                    type = feature.type;

                ctx.fillStyle = feature.tags.color ? feature.tags.color : 'transparent';
                ctx.beginPath();

                for (var j = 0; j < feature.geometry.length; j++) {
                    var geom = feature.geometry[j];

                    if (type === 1) {
                        ctx.arc(geom[0] * ratio + pad, geom[1] * ratio + pad, 2, 0, 2 * Math.PI, false);
                        continue;
                    }

                    for (var k = 0; k < geom.length; k++) {
                        var p = geom[k];
                        var extent = 4096;

                        var x = p[0] / extent * 256;
                        var y = p[1] / extent * 256;
                        if (k) ctx.lineTo(x  + pad, y   + pad);
                        else ctx.moveTo(x  + pad, y  + pad);
                    }
                }

                if (type === 3 || type === 1) ctx.fill();
                ctx.stroke();
            }

        };
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
var layerControl =new L.control.layers(basemaps,{
        "Zipcodes": tileLayer,
        "Selected Zipcodes": queue,
        
      }, {
        collapsed: false
      }).addTo(map);

			});

   
    
    
  
    
    
    
    
    
    
    
    
    
    
    
</script>

<!--End Map Post Content-->
<!--_includes/footer.html-->
</body>
<footer>
  
 
  
  
  <script>
/*_includes/analytics.js*/
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63802107-1', 'auto');
ga('send', 'pageview');
</script>

</footer>

<!--end map.html layout-->


<!--end default layout-->
</html>
